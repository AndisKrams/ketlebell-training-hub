{% extends 'base.html' %}

{% block content %}
<div class="row mt-4">
  <div class="col-md-8">
    <h2>Order {{ order.order_number }}</h2>
    <p class="small text-muted">Placed {{ order.date }} — Status: {{ order.status|capfirst }}</p>

    <h4 class="mt-3">Items</h4>
    <ul class="list-group mb-3">
      {% for li in items %}
        <li class="list-group-item d-flex justify-content-between">
          <div>
            <strong>{{ li.product_name }}</strong>
            <div class="small text-muted">Qty: {{ li.quantity }}</div>
          </div>
          <div>
            £{{ li.price }}
          </div>
        </li>
      {% endfor %}
    </ul>

    <div class="mb-3">
      <strong>Total: £{{ order.total }}</strong>
    </div>

    {% if contact_messages %}
      <h4 class="mt-4">Messages about this order</h4>
      <ul class="list-group">
        {% for cm in contact_messages %}
          <li class="list-group-item">
            <div class="d-flex justify-content-between">
              <div>
                <strong>{{ cm.subject|default:'(no subject)' }}</strong>
                <div class="small text-muted">From {{ cm.user.get_full_name }} — Sent {{ cm.created }}</div>
              </div>
              <div class="text-end">
                {% if cm.copied_to_email %}
                  <span class="badge bg-secondary">Copied</span>
                {% endif %}
              </div>
            </div>
            <div class="mt-2">{{ cm.message|linebreaks }}</div>
          </li>
        {% endfor %}
      </ul>
    {% endif %}

  </div>
</div>
{% endblock %}
